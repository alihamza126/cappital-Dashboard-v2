import{r as n,j as e}from"./react-BLQlKNq_.js";import{u as ue}from"./notistack-DWKSkMQ9.js";import{a as f}from"./index-B50ReYK6.js";import{B as $,b as P,v as z,am as H,al as l,G as h,H as x,J as p,f as i,R as d,m as he,n as xe,F as S,aE as pe,a8 as je,w as me,P as fe,x as ge,j as ve,T as N,a as o,y as Ce,an as E,I as G,ao as ye,ap as be,z as Se,af as we,ag as Me,ah as Ie,ai as Te}from"./@mui-DAjQFfGe.js";import"./@babel-HOuxngs4.js";import"./react-dom-DmmE3xc2.js";import"./scheduler-CzFDRTuY.js";import"./goober-DovPBWGu.js";import"./react-router-dom-BCp3cZHX.js";import"./react-router-CeklShVs.js";import"./@remix-run-CbFatO5U.js";import"./react-redux-10GvvXuy.js";import"./use-sync-external-store-De7g8zNk.js";import"./axios-Cm0UX6qg.js";import"./@reduxjs-DVdFRU_h.js";import"./redux-DITMfSWq.js";import"./immer-BWU1mfoO.js";import"./reselect-BeKUwQU7.js";import"./redux-thunk-ClJT1hhx.js";import"./react-typed-DYA10Kre.js";import"./typed.js-exEGtOgn.js";import"./react-bootstrap-sweetalert-DQB2ynYp.js";import"./prop-types-C1xvqhu3.js";import"./swiper-DTKdPQEP.js";import"./fslightbox-react-CQdsEJ3s.js";import"./react-bootstrap-C0bN-j8n.js";import"./classnames-BfIYw_zE.js";import"./@restart-JOvkJ3VN.js";import"./dom-helpers-nL1pTuZz.js";import"./react-transition-group-DSzsIoyj.js";import"./react-lazyload-DZ8paPqQ.js";import"./react-loading-skeleton-D7jF0Q-E.js";import"./@emotion-C2ZuPDAx.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-NkKAe6Bn.js";import"./clsx-B-dksMZM.js";import"./@popperjs-BQBsAJpH.js";const xt=()=>{var R,_;const[v,Q]=n.useState([]),[A,J]=n.useState([]),[Oe,L]=n.useState(!1),[K,D]=n.useState(!1),[C,w]=n.useState(null),[y,V]=n.useState([]),[M,X]=n.useState([]),[u,Y]=n.useState(""),[F,Z]=n.useState(""),[I,U]=n.useState(0),[T,q]=n.useState(10),[ee,te]=n.useState(0),[a,g]=n.useState({subject:"",chapter:"",topic:"",difficulty:""}),[m,k]=n.useState(""),{enqueueSnackbar:j}=ue(),[r,c]=n.useState({question:"",options:["","","",""],correctOption:0,subject:"",chapter:"",topic:"",difficulty:"easy",category:"normal",course:"mdcat",info:"",explain:"",imageUrl:"",seriesId:"",testId:""});n.useEffect(()=>{se(),O()},[u,I,T]),n.useEffect(()=>{u&&re(u)},[u]),n.useEffect(()=>{ie()},[a,m,A]);const se=async()=>{try{const t=await f.get("/series/all");console.log(t.data),V(t.data||[])}catch(t){console.error("Error fetching series:",t),j("Failed to fetch series",{variant:"error"})}},re=async t=>{try{const s=await f.get(`/tests/series/${t}`);X(s.data||[])}catch(s){console.error("Error fetching tests:",s),j("Failed to fetch tests",{variant:"error"})}},O=async()=>{if(u){L(!0);try{const t=new URLSearchParams({page:I+1,limit:T,...a}),s=await f.get(`/series-mcqs/series/${u}?${t}`);Q(s.data.mcqs||[]),J(s.data.mcqs||[]),te(s.data.total||0)}catch(t){console.error("Error fetching MCQs:",t),j("Failed to fetch MCQs",{variant:"error"})}finally{L(!1)}}},ie=()=>{let t=[...A];m&&(t=t.filter(s=>s.question.toLowerCase().includes(m.toLowerCase())||s.chapter.toLowerCase().includes(m.toLowerCase())||s.topic.toLowerCase().includes(m.toLowerCase()))),a.subject&&(t=t.filter(s=>s.subject===a.subject)),a.chapter&&(t=t.filter(s=>s.chapter.toLowerCase().includes(a.chapter.toLowerCase()))),a.topic&&(t=t.filter(s=>s.topic.toLowerCase().includes(a.topic.toLowerCase()))),a.difficulty&&(t=t.filter(s=>s.difficulty===a.difficulty)),Q(t)},B=(t=null)=>{t?(w(t),c({question:t.question,options:t.options,correctOption:t.correctOption,subject:t.subject,chapter:t.chapter,topic:t.topic,difficulty:t.difficulty,category:t.category,course:t.course,info:t.info||"",explain:t.explain||"",imageUrl:t.imageUrl||"",seriesId:t.seriesId,testId:t.testId||""})):(w(null),c({question:"",options:["","","",""],correctOption:0,subject:"",chapter:"",topic:"",difficulty:"easy",category:"normal",course:"mdcat",info:"",explain:"",imageUrl:"",seriesId:u,testId:F})),D(!0)},W=()=>{D(!1),w(null),c({question:"",options:["","","",""],correctOption:0,subject:"",chapter:"",topic:"",difficulty:"easy",category:"normal",course:"mdcat",info:"",explain:"",imageUrl:"",seriesId:"",testId:""})},le=async()=>{try{C?(await f.put(`/series-mcqs/${C._id}`,r),j("MCQ updated successfully",{variant:"success"})):(await f.post("/series-mcqs",r),j("MCQ created successfully",{variant:"success"})),W(),O()}catch(t){console.error("Error saving MCQ:",t),j("Failed to save MCQ",{variant:"error"})}},ae=async t=>{if(window.confirm("Are you sure you want to delete this MCQ?"))try{await f.delete(`/series-mcqs/${t}`),j("MCQ deleted successfully",{variant:"success"}),O()}catch(s){console.error("Error deleting MCQ:",s),j("Failed to delete MCQ",{variant:"error"})}},ne=(t,s)=>{const b=[...r.options];b[t]=s,c({...r,options:b})},ce=()=>{g({subject:"",chapter:"",topic:"",difficulty:""}),k("")},oe=(t,s)=>{U(s)},de=t=>{q(parseInt(t.target.value,10)),U(0)};return e.jsxs($,{sx:{p:3},children:[e.jsx(P,{variant:"h4",gutterBottom:!0,children:"Series MCQ Management"}),e.jsx(z,{sx:{mb:3},children:e.jsx(H,{children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Select Series"}),e.jsx(p,{value:u,onChange:t=>Y(t.target.value),label:"Select Series",children:y&&(y==null?void 0:y.map(t=>e.jsx(i,{value:t._id,children:t.title},t._id)))})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Select Test (Optional)"}),e.jsxs(p,{value:F,onChange:t=>Z(t.target.value),label:"Select Test (Optional)",children:[e.jsx(i,{value:"",children:"All Tests"}),M==null?void 0:M.map(t=>e.jsx(i,{value:t._id,children:t.title},t._id))]})]})})]})})}),e.jsx(z,{sx:{mb:3},children:e.jsx(H,{children:e.jsxs(l,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(d,{fullWidth:!0,placeholder:"Search questions...",value:m,onChange:t=>k(t.target.value),InputProps:{startAdornment:e.jsx(he,{position:"start",children:e.jsx(xe,{})})}})}),e.jsx(l,{item:!0,xs:12,md:2,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Subject"}),e.jsxs(p,{value:a.subject,onChange:t=>g({...a,subject:t.target.value}),label:"Subject",children:[e.jsx(i,{value:"",children:"All"}),e.jsx(i,{value:"physics",children:"Physics"}),e.jsx(i,{value:"chemistry",children:"Chemistry"}),e.jsx(i,{value:"biology",children:"Biology"}),e.jsx(i,{value:"english",children:"English"}),e.jsx(i,{value:"mathematics",children:"Mathematics"}),e.jsx(i,{value:"logic",children:"Logic"}),e.jsx(i,{value:"others",children:"Others"})]})]})}),e.jsx(l,{item:!0,xs:12,md:2,children:e.jsx(d,{fullWidth:!0,placeholder:"Chapter",value:a.chapter,onChange:t=>g({...a,chapter:t.target.value})})}),e.jsx(l,{item:!0,xs:12,md:2,children:e.jsx(d,{fullWidth:!0,placeholder:"Topic",value:a.topic,onChange:t=>g({...a,topic:t.target.value})})}),e.jsx(l,{item:!0,xs:12,md:2,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Difficulty"}),e.jsxs(p,{value:a.difficulty,onChange:t=>g({...a,difficulty:t.target.value}),label:"Difficulty",children:[e.jsx(i,{value:"",children:"All"}),e.jsx(i,{value:"easy",children:"Easy"}),e.jsx(i,{value:"medium",children:"Medium"}),e.jsx(i,{value:"hard",children:"Hard"})]})]})}),e.jsx(l,{item:!0,xs:12,md:1,children:e.jsx(S,{variant:"outlined",onClick:ce,startIcon:e.jsx(pe,{}),children:"Clear"})})]})})}),e.jsxs($,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(P,{variant:"h6",children:["MCQs: ",v.length]}),e.jsx(S,{variant:"contained",startIcon:e.jsx(je,{}),onClick:()=>B(),disabled:!u,children:"Add MCQ"})]}),e.jsxs(me,{component:fe,children:[e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsxs(N,{children:[e.jsx(o,{children:"Question"}),e.jsx(o,{children:"Subject"}),e.jsx(o,{children:"Chapter"}),e.jsx(o,{children:"Topic"}),e.jsx(o,{children:"Difficulty"}),e.jsx(o,{children:"Test"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(Ce,{children:v==null?void 0:v.map(t=>{var s;return e.jsxs(N,{children:[e.jsx(o,{children:e.jsx(P,{variant:"body2",noWrap:!0,sx:{maxWidth:200},children:t.question})}),e.jsx(o,{children:e.jsx(E,{label:t.subject.charAt(0).toUpperCase()+t.subject.slice(1),size:"small"})}),e.jsx(o,{children:t.chapter}),e.jsx(o,{children:t.topic}),e.jsx(o,{children:e.jsx(E,{label:t.difficulty,size:"small",color:t.difficulty==="easy"?"success":t.difficulty==="medium"?"warning":"error"})}),e.jsx(o,{children:((s=t.testId)==null?void 0:s.title)||"Not assigned"}),e.jsxs(o,{children:[e.jsx(G,{onClick:()=>B(t),children:e.jsx(ye,{})}),e.jsx(G,{onClick:()=>ae(t._id),color:"error",children:e.jsx(be,{})})]})]},t._id)})})]}),e.jsx(Se,{rowsPerPageOptions:[5,10,25],component:"div",count:ee,rowsPerPage:T,page:I,onPageChange:oe,onRowsPerPageChange:de})]}),e.jsxs(we,{open:K,onClose:W,maxWidth:"md",fullWidth:!0,children:[e.jsx(Me,{children:C?"Edit MCQ":"Add New MCQ"}),e.jsx(Ie,{children:e.jsxs(l,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Question",multiline:!0,rows:3,value:r.question,onChange:t=>c({...r,question:t.target.value})})}),(R=r==null?void 0:r.options)==null?void 0:R.map((t,s)=>e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:`Option ${s+1}`,value:t,onChange:b=>ne(s,b.target.value),InputProps:{endAdornment:e.jsx(E,{label:r.correctOption===s?"Correct":"",color:r.correctOption===s?"success":"default",size:"small"})}})},s)),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Correct Option"}),e.jsx(p,{value:r.correctOption,onChange:t=>c({...r,correctOption:t.target.value}),label:"Correct Option",children:(_=r==null?void 0:r.options)==null?void 0:_.map((t,s)=>e.jsxs(i,{value:s,children:["Option ",s+1]},s))})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Subject"}),e.jsxs(p,{value:r.subject,onChange:t=>c({...r,subject:t.target.value}),label:"Subject",children:[e.jsx(i,{value:"physics",children:"Physics"}),e.jsx(i,{value:"chemistry",children:"Chemistry"}),e.jsx(i,{value:"biology",children:"Biology"}),e.jsx(i,{value:"english",children:"English"}),e.jsx(i,{value:"mathematics",children:"Mathematics"}),e.jsx(i,{value:"logic",children:"Logic"}),e.jsx(i,{value:"others",children:"Others"})]})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Chapter",value:r.chapter,onChange:t=>c({...r,chapter:t.target.value})})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Topic",value:r.topic,onChange:t=>c({...r,topic:t.target.value})})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Difficulty"}),e.jsxs(p,{value:r.difficulty,onChange:t=>c({...r,difficulty:t.target.value}),label:"Difficulty",children:[e.jsx(i,{value:"easy",children:"Easy"}),e.jsx(i,{value:"medium",children:"Medium"}),e.jsx(i,{value:"hard",children:"Hard"})]})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Category"}),e.jsxs(p,{value:r.category,onChange:t=>c({...r,category:t.target.value}),label:"Category",children:[e.jsx(i,{value:"normal",children:"Normal"}),e.jsx(i,{value:"critical",children:"Critical"})]})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(h,{fullWidth:!0,children:[e.jsx(x,{children:"Course"}),e.jsxs(p,{value:r.course,onChange:t=>c({...r,course:t.target.value}),label:"Course",children:[e.jsx(i,{value:"mdcat",children:"MDCAT"}),e.jsx(i,{value:"ecat",children:"ECAT"}),e.jsx(i,{value:"nts",children:"NTS"})]})]})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Image URL (Optional)",value:r.imageUrl,onChange:t=>c({...r,imageUrl:t.target.value})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Info (Optional)",multiline:!0,rows:2,value:r.info,onChange:t=>c({...r,info:t.target.value})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Explanation (Optional)",multiline:!0,rows:3,value:r.explain,onChange:t=>c({...r,explain:t.target.value})})})]})}),e.jsxs(Te,{children:[e.jsx(S,{onClick:W,children:"Cancel"}),e.jsx(S,{onClick:le,variant:"contained",children:C?"Update":"Create"})]})]})]})};export{xt as default};
