import{r as x,j as e}from"./react-BLQlKNq_.js";import{u as ee}from"./notistack-DWKSkMQ9.js";import{a as T}from"./index-BZIQzIKv.js";import{F as p,a8 as te,al as i,v as M,am as R,b as c,w as se,P as ie,x as re,j as le,T as E,a,y as ae,B as g,an as f,I as w,aj as ne,ao as ce,ap as oe,af as B,ag as U,ah as F,R as d,G as N,H as q,J as z,f as L,aq as de,ar as ue,ai as O,as as xe,at as K,ad as he}from"./@mui-JR0bzeok.js";import"./@babel-HOuxngs4.js";import"./react-dom-DmmE3xc2.js";import"./scheduler-CzFDRTuY.js";import"./goober-DovPBWGu.js";import"./react-router-dom-BCp3cZHX.js";import"./react-router-CeklShVs.js";import"./@remix-run-CbFatO5U.js";import"./react-redux-10GvvXuy.js";import"./use-sync-external-store-De7g8zNk.js";import"./axios-Cm0UX6qg.js";import"./@reduxjs-DVdFRU_h.js";import"./redux-DITMfSWq.js";import"./immer-BWU1mfoO.js";import"./reselect-BeKUwQU7.js";import"./redux-thunk-ClJT1hhx.js";import"./react-typed-DYA10Kre.js";import"./typed.js-exEGtOgn.js";import"./react-bootstrap-sweetalert-DQB2ynYp.js";import"./prop-types-C1xvqhu3.js";import"./swiper-DTKdPQEP.js";import"./fslightbox-react-CQdsEJ3s.js";import"./react-bootstrap-C0bN-j8n.js";import"./classnames-BfIYw_zE.js";import"./@restart-JOvkJ3VN.js";import"./dom-helpers-nL1pTuZz.js";import"./react-transition-group-DSzsIoyj.js";import"./react-lazyload-DZ8paPqQ.js";import"./react-loading-skeleton-D7jF0Q-E.js";import"./@emotion-C2ZuPDAx.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./stylis-NkKAe6Bn.js";import"./clsx-B-dksMZM.js";import"./@popperjs-BQBsAJpH.js";const Ye=()=>{var k;const[j,_]=x.useState([]),[I,h]=x.useState(!1),[$,W]=x.useState(!1),[v,S]=x.useState(null),[o,b]=x.useState(null),{enqueueSnackbar:m}=ee(),[s,l]=x.useState({slug:"",title:"",coverImageUrl:"",description:"",subjects:[],difficulty:"Beginner",price:"",originalPrice:"",tags:[],totalTests:"",totalDurationMin:"",isActive:!0,expiresAt:""}),[n,C]=x.useState({}),G=["Biology","Chemistry","Physics","English","Mathematics","Logic"],H=["Beginner","Intermediate","Advanced"];x.useEffect(()=>{A()},[]);const A=async()=>{try{h(!0);const t=await T.get("/series/all");_(t.data)}catch{m("Failed to fetch series",{variant:"error"})}finally{h(!1)}},D=(t=null)=>{t?(S(t),l({slug:t.slug,title:t.title,coverImageUrl:t.coverImageUrl||"",description:t.description,subjects:t.subjects,difficulty:t.difficulty,price:t.price,originalPrice:t.originalPrice||"",tags:t.tags||[],totalTests:t.totalTests,totalDurationMin:t.totalDurationMin||"",isActive:t.isActive,expiresAt:t.expiresAt?new Date(t.expiresAt).toISOString().split("T")[0]:""})):(S(null),l({slug:"",title:"",coverImageUrl:"",description:"",subjects:[],difficulty:"Beginner",price:"",originalPrice:"",tags:[],totalTests:"",totalDurationMin:"",isActive:!0,expiresAt:""})),C({}),W(!0)},P=()=>{W(!1),S(null),C({})},V=()=>{const t={};return s.slug||(t.slug="Slug is required"),s.title||(t.title="Title is required"),s.description||(t.description="Description is required"),s.subjects.length===0&&(t.subjects="At least one subject is required"),s.price||(t.price="Price is required"),s.totalTests||(t.totalTests="Total tests is required"),C(t),Object.keys(t).length===0},J=async()=>{var t,r;if(V())try{h(!0);const u={...s,price:Number(s.price),originalPrice:s.originalPrice?Number(s.originalPrice):void 0,totalTests:Number(s.totalTests),totalDurationMin:s.totalDurationMin?Number(s.totalDurationMin):void 0,expiresAt:s.expiresAt?new Date(s.expiresAt):void 0};v?(await T.put(`/series/${v._id}`,u),m("Series updated successfully",{variant:"success"})):(await T.post("/series",u),m("Series created successfully",{variant:"success"})),P(),A()}catch(u){m(((r=(t=u.response)==null?void 0:t.data)==null?void 0:r.error)||"Operation failed",{variant:"error"})}finally{h(!1)}},Q=async t=>{if(window.confirm("Are you sure you want to delete this series? This action cannot be undone."))try{h(!0),await T.delete(`/series/${t}`),m("Series deleted successfully",{variant:"success"}),A()}catch{m("Failed to delete series",{variant:"error"})}finally{h(!1)}},X=t=>{l({...s,subjects:t.target.value})},Y=t=>{const r=t.target.value;l({...s,tags:typeof r=="string"?r.split(","):r})},y=(t,r,u,Z)=>e.jsx(M,{sx:{minWidth:275,bgcolor:Z},children:e.jsx(R,{children:e.jsxs(g,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(g,{children:[e.jsx(c,{variant:"h6",component:"div",color:"white",children:t}),e.jsx(c,{variant:"h4",component:"div",color:"white",children:r})]}),e.jsx(g,{color:"white",children:u})]})})});return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-sm-flex align-items-center justify-content-between mb-4",children:[e.jsx("h1",{className:"h3 mb-0 text-gray-800",children:"Series Management"}),e.jsx(p,{variant:"contained",startIcon:e.jsx(te,{}),onClick:()=>D(),sx:{bgcolor:"#4e73df"},children:"Add New Series"})]}),e.jsxs(i,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:y("Total Series",j.length,e.jsx(xe,{}),"#4e73df")}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:y("Active Series",j.filter(t=>t.isActive).length,e.jsx(K,{}),"#1cc88a")}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:y("Total Tests",j.reduce((t,r)=>t+r.totalTests,0),e.jsx(K,{}),"#f6c23e")}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:y("Total Revenue",`PKR ${j.reduce((t,r)=>t+r.price,0).toLocaleString()}`,e.jsx(he,{}),"#e74a3b")})]}),e.jsx(M,{children:e.jsxs(R,{children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"All Series"}),e.jsx(se,{component:ie,children:e.jsxs(re,{children:[e.jsx(le,{children:e.jsxs(E,{children:[e.jsx(a,{children:"Title"}),e.jsx(a,{children:"Slug"}),e.jsx(a,{children:"Subjects"}),e.jsx(a,{children:"Price"}),e.jsx(a,{children:"Tests"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(ae,{children:j.map(t=>e.jsxs(E,{children:[e.jsx(a,{children:e.jsxs(g,{display:"flex",alignItems:"center",children:[t.coverImageUrl&&e.jsx("img",{src:t.coverImageUrl,alt:t.title,style:{width:40,height:40,marginRight:10,borderRadius:4}}),e.jsx(c,{variant:"body2",children:t.title})]})}),e.jsx(a,{children:t.slug}),e.jsx(a,{children:t.subjects.map((r,u)=>e.jsx(f,{label:r,size:"small",sx:{mr:.5,mb:.5}},u))}),e.jsxs(a,{children:["PKR ",t.price]}),e.jsx(a,{children:t.totalTests}),e.jsx(a,{children:e.jsx(f,{label:t.isActive?"Active":"Inactive",color:t.isActive?"success":"default",size:"small"})}),e.jsxs(a,{children:[e.jsx(w,{size:"small",onClick:()=>b(t),color:"primary",children:e.jsx(ne,{})}),e.jsx(w,{size:"small",onClick:()=>D(t),color:"primary",children:e.jsx(ce,{})}),e.jsx(w,{size:"small",onClick:()=>Q(t._id),color:"error",children:e.jsx(oe,{})})]})]},t._id))})]})})]})}),e.jsxs(B,{open:$,onClose:P,maxWidth:"md",fullWidth:!0,children:[e.jsx(U,{children:v?"Edit Series":"Add New Series"}),e.jsx(F,{children:e.jsxs(i,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Slug",value:s.slug,onChange:t=>l({...s,slug:t.target.value}),error:!!n.slug,helperText:n.slug,placeholder:"e.g., mdcat-series-2025"})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Title",value:s.title,onChange:t=>l({...s,title:t.target.value}),error:!!n.title,helperText:n.title})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Cover Image URL",value:s.coverImageUrl,onChange:t=>l({...s,coverImageUrl:t.target.value}),placeholder:"https://example.com/image.jpg"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(d,{fullWidth:!0,label:"Description",value:s.description,onChange:t=>l({...s,description:t.target.value}),multiline:!0,rows:3,error:!!n.description,helperText:n.description})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(N,{fullWidth:!0,error:!!n.subjects,children:[e.jsx(q,{children:"Subjects"}),e.jsx(z,{multiple:!0,value:s.subjects,onChange:X,renderValue:t=>e.jsx(g,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(r=>e.jsx(f,{label:r,size:"small"},r))}),children:G.map(t=>e.jsx(L,{value:t,children:t},t))}),n.subjects&&e.jsx(c,{variant:"caption",color:"error",children:n.subjects})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(N,{fullWidth:!0,children:[e.jsx(q,{children:"Difficulty"}),e.jsx(z,{value:s.difficulty,onChange:t=>l({...s,difficulty:t.target.value}),children:H.map(t=>e.jsx(L,{value:t,children:t},t))})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Price (PKR)",type:"number",value:s.price,onChange:t=>l({...s,price:t.target.value}),error:!!n.price,helperText:n.price})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Original Price (PKR)",type:"number",value:s.originalPrice,onChange:t=>l({...s,originalPrice:t.target.value})})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Total Tests",type:"number",value:s.totalTests,onChange:t=>l({...s,totalTests:t.target.value}),error:!!n.totalTests,helperText:n.totalTests})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Total Duration (minutes)",type:"number",value:s.totalDurationMin,onChange:t=>l({...s,totalDurationMin:t.target.value})})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Tags (comma-separated)",value:s.tags.join(","),onChange:Y,placeholder:"mdcat, medical, exam"})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(d,{fullWidth:!0,label:"Expires At",type:"date",value:s.expiresAt,onChange:t=>l({...s,expiresAt:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(de,{control:e.jsx(ue,{checked:s.isActive,onChange:t=>l({...s,isActive:t.target.checked})}),label:"Active"})})]})}),e.jsxs(O,{children:[e.jsx(p,{onClick:P,children:"Cancel"}),e.jsx(p,{onClick:J,variant:"contained",disabled:I,sx:{bgcolor:"#4e73df"},children:I?"Saving...":v?"Update":"Create"})]})]}),e.jsx(B,{open:!!o,onClose:()=>b(null),maxWidth:"md",fullWidth:!0,children:o&&e.jsxs(e.Fragment,{children:[e.jsx(U,{children:"Series Details"}),e.jsx(F,{children:e.jsxs(i,{container:!0,spacing:2,children:[e.jsxs(i,{item:!0,xs:12,children:[e.jsx(c,{variant:"h6",children:o.title}),e.jsx(c,{variant:"body2",color:"textSecondary",children:o.slug})]}),e.jsx(i,{item:!0,xs:12,children:e.jsx(c,{variant:"body1",children:o.description})}),e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsx(c,{variant:"subtitle2",children:"Subjects:"}),o.subjects.map((t,r)=>e.jsx(f,{label:t,size:"small",sx:{mr:.5,mb:.5}},r))]}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(c,{variant:"subtitle2",children:["Difficulty: ",o.difficulty]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(c,{variant:"subtitle2",children:["Price: PKR ",o.price]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(c,{variant:"subtitle2",children:["Total Tests: ",o.totalTests]})}),e.jsxs(i,{item:!0,xs:12,children:[e.jsx(c,{variant:"subtitle2",children:"Tags:"}),(k=o.tags)==null?void 0:k.map((t,r)=>e.jsx(f,{label:t,size:"small",sx:{mr:.5,mb:.5}},r))]})]})}),e.jsxs(O,{children:[e.jsx(p,{onClick:()=>b(null),children:"Close"}),e.jsx(p,{onClick:()=>{b(null),D(o)},variant:"contained",sx:{bgcolor:"#4e73df"},children:"Edit"})]})]})})]})};export{Ye as default};
